<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Ardupilot Postmortem - Scott O'Brien</title><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css><link rel=stylesheet type=text/css href=/assets/css/normalize.css><link rel=stylesheet type=text/css href=/assets/css/icons.css><link rel=stylesheet type=text/css href=/assets/css/screen.css><link href="https://fonts.googleapis.com/css?family=Bree+Serif|Lato:100,100i,300,300i,400,400i,700,700i|Source+Code+Pro:300,400,500,700" rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js crossorigin=anonymous referrerpolicy=no-referrer></script>
<script src=https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js></script>
<script type=text/javascript src=/assets/bigfoot/dist/bigfoot.js></script>
<link rel=stylesheet type=text/css href=/assets/bigfoot/dist/bigfoot-number.css><script type=text/javascript>$.bigfoot()</script></head><body class=post-template><header class=main-header><div class=main-header-content><h1 class=blog-title><a href=/>Scott O'Brien</a></h1><h2 class=blog-description>Projects, Ramblings and Resources of my (online) life</h2></div><div class=nav><a class=nav- role=presentation href=/page/bucketlist/>The Bucket List</a>
<a class=nav- role=presentation href=/page/about/>About Me</a>
<a class=nav- role=presentation href=/recipes/>Recipes</a>
<a class=nav- role=presentation href=/flying/>Flying</a></div></header><main class=content role=main><article class=post><header class=post-header><img src=/post/ardupilot-postmortem/crash.jpg></img><h2 class=post-title>Ardupilot Postmortem</h2><section class=post-meta><time class=post-date>November 27, 2022</time></section></header><section class=post-content><p><em><strong>NOTE: This post is expected to be edited once I have more opinions from the community and get closer to a concrete conclusion of what happened.</strong></em></p><p>So I took Monday-Wednesday off. Figured a 9 day weekend would give me a nice break.</p><p>I spent a lot of time finishing an RC plane we had some replacement parts for. This one was going to be autonomous. I spent a few days soldering the flight controller and electronics, gluing the plane together, measuring and trimming everything perfectly. It was perfectly balanced, perfectly weighted. We finally took it out for a maiden flight today, Sunday November 27. Sadly, this story ends in pieces.</p><p>This post is to try and perform a postmortem of the incident to piece together what happened. I was flying using Ardupilot and had an SD card in recording the data, so, hopefully the &ldquo;black box&rdquo; telemetry data be able to figure out what went wrong here.</p><h3 id=plane-hardware>Plane Hardware</h3><ul><li><strong>Plane</strong>: <a href=https://hobbyking.com/en_us/h-king-bixler-3-glider-1550-pnf.html>Bixler 3</a></li><li><strong>Flight Controller</strong>: <a href=https://ardupilot.org/copter/docs/common-holybro-kakutef7aio.html>Holybro Kakute F7</a></li><li><strong>GPS, Compass</strong>: <a href=https://ardupilot.org/copter/docs/common-beitian-gps.html>Beitian BN-880</a></li><li><strong>Ardupilot</strong>: Arduplane V4.3.1</li></ul><h3 id=tools--files>Tools & Files</h3><ul><li><a href=https://ardupilot.org/dev/docs/common-uavlogviewer.html>UAV Logviewer</a></li><li>Ardupilot <strong><a href=/post/ardupilot-postmortem/log.bin>LOG FILE</a></strong></li></ul><h3 id=theories--investigation>Theories & Investigation</h3><p>The flight controller has a BMP280 barometer for quick height sensing and a ICM20689 IMU for acceleration and gyro. These, coupled with a slower GPS update time should give me fairly accurate height and position updates. The plane acted erratic twice in the short two-minute flight. I have pieced together the events and suspect two failures during this flights short duration. The following is a timeline view of the events of the flight and findings at that time.</p><h3 id=events>Events</h3><h4 id=1-bad-altitude-readings-pre-launch>1 Bad Altitude Readings Pre-Launch</h4><p>The first thing to note, is that the Altitude readings are bogus. I seem to be getting more realistic readings from the GPS. Going forward, any screenshots will be from the GPS altitude.</p><video width=100% loop=true controls autoplay muted>
<source src=/post/ardupilot-postmortem/altitude.mp4></video><p><img src=/post/ardupilot-postmortem/Altitude.jpg alt=altitude></p><p>The altitude readings are super interesting here. You can tell even before I launch the plane, the GPS altitude readings are between -13m and 0m. Not sure what this altitude is (above sea? Above launch??)</p><p>More concerning, the Barometer altitude is between -10 and -70m in the ~1 minute before launch on the ground. The calculated AHRS (Attitude Heading Reference System) altitude at somewhat similar, -9 and -80 ðŸ«¤</p><p>The maiden launch itself in manual mode however was nominal. You can hear me saying &ldquo;Good luck little plane&rdquo;. It needed more than luck it seems</p><iframe width=560 height=315 src=https://www.youtube.com/embed/D03_c0LWJhM title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h4 id=2-fly-by-wire-test>2. Fly-By-Wire Test</h4><p>At ~1 minute 22 seconds into the flight, I turned the flight mode from manual to <a href=https://ardupilot.org/plane/docs/fbwa-mode.html>Fly by wire A</a>, which should have had the effect of assisting the plane in straight line. Looking at the radio stick input, I did not change the heading, but the autopilot sent this into a steep dive at this time. A near miss where we avoided a crash here.</p><p><img src=/post/ardupilot-postmortem/fbw.jpg alt=FBW></p><h4 id=theory-1-reversed-elevator>Theory 1 Reversed Elevator?</h4><p><img src=/post/ardupilot-postmortem/Nosedive1.jpg alt=nosedive>
12:24 is interesting here, If we take the time we engage the autopilot, we can see the pitch heading down into the ground, before our roll even begins to change. It ends up to a point where it&rsquo;s almost completely nose down before we save it with manual flight mode.</p><p>What&rsquo;s interesting, is that the pitch continues to fall, and the AETR Elevator gets more and more positive. Is it possible that we&rsquo;re trying to correct the nose down and instead making it worse? Could the elevator be reversed?</p><h3 id=event-3--crash-elevator-failure>Event 3. Crash (elevator failure?)</h3><p>This event makes me believe that I had an elevator failure during the flight, and, in a panic I &ldquo;checked&rdquo; my autopilot settings, and accidentally turned it on.</p><p><strong>Events:</strong></p><ul><li>Nominal flight approaching turn</li><li>Banks left to enter turn</li><li>Starts pitching down, control toggles are pulling back on the elevator, manual flight mode still engaged</li><li>Plane is not responsive and is still pitching down</li><li>After loosing much altitude, in a panic, RTL is engaged.</li><li>Plane starts pitching nose down further once RTL is engaged (reversed elevator theory?) causing the epic crash with almost full speed, full nose down.</li></ul><video width=100% controls autoplay muted>
<source src=/post/ardupilot-postmortem/crash.mp4></video><h3 id=lessons>Lessons</h3><ul><li>Don&rsquo;t fly with so much throttle. Mistakes happen a <em>lot</em> faster than it could otherwise happen</li><li>Test the FBWA modes on the ground. Ensure that the elevator, ailerons and rudder is behaving as expected in relationship to pitch, roll movements.</li><li>Be sure to glue in everything! I&rsquo;m not convinced a servo could have come loose during this flight, though unlikely considering it to be the elevator that&rsquo;s unresponsive. Perhaps elevator could have been &ldquo;stuck&rdquo; or something? Loose screw on the servo? Who knows.</li><li>When packing up a catastrophic crash, take stock of failed components, what servo is for what. Re-create postmortem to analyze suspect failed components.</li></ul></section><footer class=post-footer><section class="tags post-meta">Tagged
<a href=https://www.scottyob.com/tags/rc/>rc</a>
<a href=https://www.scottyob.com/tags/ardupilot/>ardupilot</a></section></footer></article></main><footer class=site-footer><section class=rss><a class="subscribe-button icon-feed" href=/index.xml></a></section><section class=copyright>&copy; 2022 Scott O'Brien</section><section class=poweredby><a href=https://github.com/nirocfz/arabica>Arabica</a> theme by Sean Lunsford. Published with <a href=https://gohugo.io>Hugo</a>.</section></footer></body></html>